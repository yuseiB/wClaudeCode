<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EM Cavity & Waveguide Visualizer</title>
  <link rel="stylesheet" href="/src/style.css" />
</head>
<body>
  <header>
    <h1>ğŸ”¬ é›»ç£æ°—ã‚­ãƒ£ãƒ“ãƒ†ã‚£ãƒ»å°æ³¢ç®¡ å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«</h1>
    <p>Electromagnetic Cavity &amp; Waveguide Field Visualizer â€” Interactive Mode Explorer</p>
  </header>

  <main>
    <div class="controls">
      <!-- View selection -->
      <div class="control-group">
        <label>è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰</label>
        <select id="viewMode">
          <option value="rect-cavity">ç›´æ–¹ä½“ã‚­ãƒ£ãƒ“ãƒ†ã‚£ (Rectangular Cavity)</option>
          <option value="rect-wg">ç›´æ–¹ä½“å°æ³¢ç®¡ (Rectangular Waveguide)</option>
          <option value="circ-wg">å††å½¢å°æ³¢ç®¡ (Circular Waveguide)</option>
        </select>
      </div>

      <!-- Presets -->
      <div class="control-group">
        <label>ãƒ—ãƒªã‚»ãƒƒãƒˆ</label>
        <div class="btn-row">
          <button data-preset="te101">TEâ‚â‚€â‚ Cavity</button>
          <button data-preset="tm110">TMâ‚â‚â‚€ Cavity</button>
          <button data-preset="te10">TEâ‚â‚€ WG</button>
          <button data-preset="te11c">TEâ‚â‚ Circ</button>
        </div>
      </div>

      <!-- Mode type -->
      <div class="control-group">
        <button id="modeTypeBtn" class="mode-btn">Mode: TE</button>
      </div>

      <!-- m, n indices -->
      <div class="control-group">
        <label>m = <span id="mVal">1</span></label>
        <input type="range" id="mSlider" min="0" max="4" value="1" />
      </div>
      <div class="control-group">
        <label>n = <span id="nVal">0</span></label>
        <input type="range" id="nSlider" min="0" max="4" value="0" />
      </div>

      <!-- p index (cavity only) -->
      <div id="pPanel" class="control-group">
        <label>p = <span id="pVal">1</span></label>
        <input type="range" id="pSlider" min="0" max="4" value="1" />
      </div>

      <!-- Frequency multiplier (waveguide only) -->
      <div id="freqPanel" class="control-group" style="display:none">
        <label>f / fc = <span id="freqVal">1.5Ã—fc</span></label>
        <input type="range" id="freqSlider" min="1.01" max="3.0" step="0.01" value="1.5" />
      </div>

      <!-- Animation -->
      <div class="control-group">
        <label>é€Ÿåº¦ (speed)</label>
        <input type="range" id="speedSlider" min="0.01" max="0.3" step="0.01" value="0.08" />
      </div>
      <div class="control-group">
        <button id="playBtn">â¸ Pause</button>
      </div>
    </div>

    <div class="canvas-area">
      <div>
        <canvas id="fieldCanvas"></canvas>
        <div id="info" class="info-box"></div>
      </div>
      <div>
        <canvas id="dispCanvas" style="display:none"></canvas>
        <div class="legend">
          <div class="legend-row"><span class="swatch swatch-hot"></span> |E| magnitude (hot: warm=high, cool=zero)</div>
          <div class="legend-row"><span class="swatch swatch-arrow" style="background:#ff0"></span> â†’ E-field direction arrows</div>
          <div class="legend-row"><span class="swatch" style="background:#4fc3f7"></span> â€” Î² dispersion curve</div>
          <div class="legend-row"><span class="swatch" style="background:#ff9800"></span> â€” cutoff frequency f<sub>c</sub></div>
          <div class="legend-row"><span class="swatch" style="background:#f44"></span> â— operating point (f, Î²)</div>
        </div>
      </div>
    </div>

    <section class="physics-notes">
      <h2>ç‰©ç†çš„ãªèƒŒæ™¯ (Physics Notes)</h2>
      <dl>
        <dt>å…±æŒ¯ã‚­ãƒ£ãƒ“ãƒ†ã‚£ (Resonant Cavity)</dt>
        <dd>PEC å£ã§å›²ã¾ã‚ŒãŸç©ºæ´å†…ã§ EM æ³¢ãŒå®šå¸¸æ³¢ã‚’å½¢æˆã€‚<br>
            E(r,t) = Eâ‚€(r)Â·<b>cos(Ï‰t)</b>ï¼ŒH(r,t) = Hâ‚€(r)Â·<b>sin(Ï‰t)</b>
            â†’ E ã¨ H ãŒ 90Â° ä½ç›¸ãšã‚Œï¼Œã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒé›»å ´â†”ç£å ´é–“ã§æŒ¯å‹•ã€‚</dd>
        <dt>å°æ³¢ç®¡ (Waveguide)</dt>
        <dd>PEC ç®¡å†…ã‚’ +z æ–¹å‘ã¸é›»ç£æ³¢ãŒä¼æ¬ã€‚<br>
            ã‚«ãƒƒãƒˆã‚ªãƒ•å‘¨æ³¢æ•° f<sub>c</sub> ä»¥ä¸‹ã§ã¯ä¼æ¬ä¸å¯ (ã‚¨ãƒãƒãƒƒã‚»ãƒ³ãƒˆ)ã€‚<br>
            ä¼æ¬å®šæ•° Î² = âˆš((Ï‰/c)Â² âˆ’ k<sub>c</sub>Â²)ï¼Œç¾¤é€Ÿåº¦ v<sub>g</sub> = cÂ²Î²/Ï‰ &lt; cã€‚</dd>
        <dt>åˆ†æ•£é–¢ä¿‚ (Dispersion Relation)</dt>
        <dd>Ï‰Â² = (Î²c)Â² + (k<sub>c</sub>c)Â² â€” åŒæ›²ç·šå‹ã€‚å…‰ã®åˆ†æ•£ Ï‰=Î²c (ç‚¹ç·š) ã¨æ¯”è¼ƒã€‚
            fc ä»¥ä¸Šã§åŒæ›²ç·šãŒå…‰ç·šã«æ¼¸è¿‘ã€‚èµ¤ç‚¹: æ“ä½œå‘¨æ³¢æ•°ã«ãŠã‘ã‚‹ (f, Î²)ã€‚</dd>
      </dl>
    </section>
  </main>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>
