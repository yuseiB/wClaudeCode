(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=e(a);fetch(a.href,s)}})();function Ft(n){return[n.theta1,n.omega1,n.theta2,n.omega2]}function At([n,t,e,o]){return{theta1:n,omega1:t,theta2:e,omega2:o}}function O(n,t){return[n[0]+t[0],n[1]+t[1],n[2]+t[2],n[3]+t[3]]}function H(n,t){return[n[0]*t,n[1]*t,n[2]*t,n[3]*t]}class Bt{constructor(t=1,e=1,o=1,a=1,s=9.81){this.m1=t,this.m2=e,this.L1=o,this.L2=a,this.g=s}eomVec([t,e,o,a]){const s=t-o,r=2*this.m1+this.m2-this.m2*Math.cos(2*s),g=(-this.g*(2*this.m1+this.m2)*Math.sin(t)-this.m2*this.g*Math.sin(t-2*o)-2*Math.sin(s)*this.m2*(a*a*this.L2+e*e*this.L1*Math.cos(s)))/(this.L1*r),T=2*Math.sin(s)*(e*e*this.L1*(this.m1+this.m2)+this.g*(this.m1+this.m2)*Math.cos(t)+a*a*this.L2*this.m2*Math.cos(s))/(this.L2*r);return[e,g,a,T]}step(t,e){const o=Ft(t),a=this.eomVec(o),s=this.eomVec(O(o,H(a,e/2))),r=this.eomVec(O(o,H(s,e/2))),g=this.eomVec(O(o,H(r,e)));return At(O(o,H([a[0]+2*s[0]+2*r[0]+g[0],a[1]+2*s[1]+2*r[1]+g[1],a[2]+2*s[2]+2*r[2]+g[2],a[3]+2*s[3]+2*r[3]+g[3]],e/6)))}kineticEnergy(t){const{theta1:e,omega1:o,theta2:a,omega2:s}=t,r=e-a;return .5*this.m1*this.L1**2*o**2+.5*this.m2*(this.L1**2*o**2+this.L2**2*s**2+2*this.L1*this.L2*o*s*Math.cos(r))}potentialEnergy(t){return-this.g*((this.m1+this.m2)*this.L1*Math.cos(t.theta1)+this.m2*this.L2*Math.cos(t.theta2))}energy(t){return this.kineticEnergy(t)+this.potentialEnergy(t)}bob1(t){return{x:this.L1*Math.sin(t.theta1),y:-this.L1*Math.cos(t.theta1)}}bob2(t){const e=this.bob1(t);return{x:e.x+this.L2*Math.sin(t.theta2),y:e.y-this.L2*Math.cos(t.theta2)}}}const kt=.001,_t=600,$t=6e3,Rt=4e3,wt=1800,pt={"Near-linear":{theta1:10*Math.PI/180,omega1:0,theta2:10*Math.PI/180,omega2:0},Intermediate:{theta1:90*Math.PI/180,omega1:0,theta2:0,omega2:0},Chaotic:{theta1:120*Math.PI/180,omega1:0,theta2:-30*Math.PI/180,omega2:0}},Z=document.getElementById("pendulum-canvas"),_=document.getElementById("phase-canvas"),$=document.getElementById("traj-canvas"),Q=document.getElementById("energy-canvas"),i=Z.getContext("2d"),m=_.getContext("2d"),f=$.getContext("2d"),l=Q.getContext("2d"),ht=document.getElementById("play-pause"),Ot=document.getElementById("reset"),mt=document.getElementById("speed"),N=document.getElementById("theta1"),Y=document.getElementById("theta2"),tt=document.getElementById("omega1"),et=document.getElementById("omega2"),Ht=document.getElementById("theta1-label"),Vt=document.getElementById("theta2-label"),Wt=document.getElementById("omega1-label"),Dt=document.getElementById("omega2-label"),Xt=document.getElementById("time-display"),jt=document.getElementById("drift-display"),nt=document.querySelectorAll(".preset-btn"),G=document.createElement("canvas");G.width=_.width;G.height=_.height;const b=G.getContext("2d"),J=document.createElement("canvas");J.width=$.width;J.height=$.height;const I=J.getContext("2d"),h=new Bt;let ot={...pt["Near-linear"]},c={...ot},K=0,W=h.energy(c),F=!1,xt=1,D=0;const P=[],X=[],j=[],p=[];let A=null,B=null;function q(n,t,e,o,a){return o+(n-t)/(e-t)*(a-o)}const at=Z.width,k=Z.height,L=at/2,v=k/2,U=(Math.min(at,k)/2-24)/(h.L1+h.L2);function V(n,t){return[L+n*U,v-t*U]}const Pt=_.width,Tt=_.height,ft=18,gt=10;function M(n,t){const e=q(n,-Math.PI,Math.PI,ft,Pt-ft),o=q(t,10,-10,gt,Tt-gt);return[e,o]}const bt=$.width,Mt=$.height,dt=12,ut=10,u=h.L1+h.L2;function C(n,t){const e=q(n,-u,u,dt,bt-dt),o=q(t,-u,u,ut,Mt-ut);return[e,o]}function yt(n,t,e){n.fillStyle="#0d0d1a",n.fillRect(0,0,t,e),n.strokeStyle="rgba(255,255,255,0.07)",n.lineWidth=1,n.beginPath(),n.moveTo(t/2,0),n.lineTo(t/2,e),n.moveTo(0,e/2),n.lineTo(t,e/2),n.stroke()}function Nt(){yt(b,Pt,Tt),yt(I,bt,Mt),A=null,B=null}function Yt(n){const t={theta2:n.theta2,omega2:n.omega2},[e,o]=M(t.theta2,t.omega2);if(A){const[a,s]=M(A.theta2,A.omega2);b.beginPath(),b.moveTo(a,s),b.lineTo(e,o),b.strokeStyle="rgba(179,100,255,0.75)",b.lineWidth=1,b.stroke()}else b.fillStyle="rgba(179,100,255,0.9)",b.fillRect(e-1,o-1,2,2);A=t}function qt(n){const[t,e]=C(n.x,n.y);if(B){const[o,a]=C(B.x,B.y);I.beginPath(),I.moveTo(o,a),I.lineTo(t,e),I.strokeStyle="rgba(255,140,0,0.65)",I.lineWidth=1,I.stroke()}B={...n}}function Gt(){i.fillStyle="#0d0d1a",i.fillRect(0,0,at,k);const n=(h.L1+h.L2)*U;if(i.beginPath(),i.arc(L,v,n,0,2*Math.PI),i.strokeStyle="rgba(255,255,255,0.05)",i.lineWidth=1,i.stroke(),i.strokeStyle="rgba(255,255,255,0.35)",i.lineWidth=1,i.beginPath(),i.moveTo(L-7,v),i.lineTo(L+7,v),i.moveTo(L,v-7),i.lineTo(L,v+7),i.stroke(),P.length>1){i.beginPath();const[T,R]=V(P[0].x,P[0].y);i.moveTo(T,R);for(let S=1;S<P.length;S++){const[d,y]=V(P[S].x,P[S].y);i.lineTo(d,y)}i.strokeStyle="rgba(255,140,0,0.28)",i.lineWidth=1.5,i.stroke()}const t=h.bob1(c),e=h.bob2(c),[o,a]=V(t.x,t.y),[s,r]=V(e.x,e.y);i.strokeStyle="rgba(200,200,230,0.8)",i.lineWidth=3,i.lineCap="round",i.beginPath(),i.moveTo(L,v),i.lineTo(o,a),i.moveTo(o,a),i.lineTo(s,r),i.stroke(),i.beginPath(),i.arc(o,a,9,0,2*Math.PI),i.fillStyle="#00c8ff",i.fill(),i.beginPath(),i.arc(s,r,11,0,2*Math.PI),i.fillStyle="#ff8c00",i.fill(),i.fillStyle="rgba(255,255,255,0.4)",i.font="11px monospace",i.textAlign="left";const g=T=>`${(T*180/Math.PI).toFixed(1)}°`;i.fillText(`θ₁=${g(c.theta1)}  ω₁=${c.omega1.toFixed(2)}`,8,k-18),i.fillText(`θ₂=${g(c.theta2)}  ω₂=${c.omega2.toFixed(2)}`,8,k-4)}function Jt(){m.drawImage(G,0,0),m.fillStyle="rgba(255,255,255,0.28)",m.font="9px monospace",m.textAlign="center",m.fillText("-π",...M(-Math.PI,0).map((e,o)=>o===1?e+12:e)),m.fillText(" 0",...M(0,0).map((e,o)=>o===1?e+12:e)),m.fillText("+π",...M(Math.PI,0).map((e,o)=>o===1?e+12:e)),m.textAlign="right",m.fillText("-10",...M(0,-10).map((e,o)=>o===0?e-2:e)),m.fillText("+10",...M(0,10).map((e,o)=>o===0?e-2:e));const[n,t]=M(c.theta2,c.omega2);m.beginPath(),m.arc(n,t,3,0,2*Math.PI),m.fillStyle="#b364ff",m.fill()}function Kt(){f.drawImage(J,0,0),f.fillStyle="rgba(255,255,255,0.28)",f.font="9px monospace",f.textAlign="center",f.fillText(`-${u}`,...C(-u,0).map((o,a)=>a===1?o-4:o)),f.fillText(`+${u}`,...C(u,0).map((o,a)=>a===1?o-4:o)),f.textAlign="right",f.fillText(`-${u}`,...C(0,-u).map((o,a)=>a===0?o-2:o)),f.fillText(`+${u}`,...C(0,u).map((o,a)=>a===0?o-2:o));const n=h.bob2(c),[t,e]=C(n.x,n.y);f.beginPath(),f.arc(t,e,3,0,2*Math.PI),f.fillStyle="#ff8c00",f.fill()}function zt(){const n=Q.width,t=Q.height,e=38,o=8,a=8,s=18,r=n-e-o,g=t-a-s;if(l.fillStyle="#0d0d1a",l.fillRect(0,0,n,t),p.length<2)return;const T=p[0].t,R=p[p.length-1].t,S=Math.max(R-T,1);let d=1/0,y=-1/0;for(const{T:x,V:w,E}of p)d=Math.min(d,x,w,E),y=Math.max(y,x,w,E);const st=Math.max((y-d)*.06,.01);d-=st,y+=st,d===y&&(d-=1,y+=1);function Ct(x){return e+(x-T)/S*r}function z(x){return a+(1-(x-d)/(y-d))*g}d<=0&&0<=y&&(l.strokeStyle="rgba(255,255,255,0.07)",l.lineWidth=1,l.beginPath(),l.moveTo(e,z(0)),l.lineTo(e+r,z(0)),l.stroke());const St=[["T","#00e676"],["V","#4fc3f7"],["E","#ffffff"]];for(const[x,w]of St){l.beginPath(),l.strokeStyle=w,l.lineWidth=x==="E"?1.8:1.2,l.globalAlpha=x==="E"?1:.75;for(let E=0;E<p.length;E++){const lt=p[E],ct=Ct(lt.t),rt=z(lt[x]);E===0?l.moveTo(ct,rt):l.lineTo(ct,rt)}l.stroke(),l.globalAlpha=1}l.fillStyle="rgba(255,255,255,0.32)",l.font="9px monospace",l.textAlign="right",l.fillText(y.toFixed(1),e-2,a+8),l.fillText(d.toFixed(1),e-2,a+g),l.textAlign="left",l.fillStyle="rgba(255,255,255,0.28)",l.fillText(`${T.toFixed(0)}s`,e,t-3),l.textAlign="right",l.fillText(`${R.toFixed(0)}s`,e+r,t-3)}function Et(){Gt(),Jt(),Kt(),zt(),Xt.textContent=K.toFixed(2);const n=W!==0?Math.abs((h.energy(c)-W)/W)*100:0;jt.textContent=n.toExponential(2)}function Qt(){const n=h.bob2(c);P.push({...n}),P.length>_t&&P.shift(),Yt(c),X.push({theta2:c.theta2,omega2:c.omega2}),X.length>$t&&X.shift(),qt(n),j.push({...n}),j.length>Rt&&j.shift(),p.push({t:K,T:h.kineticEnergy(c),V:h.potentialEnergy(c),E:h.energy(c)}),p.length>wt&&p.shift()}function It(n){if(F){const e=(D>0?Math.min((n-D)/1e3,.1):0)*xt,o=Math.max(1,Math.round(e/kt)),a=e/o;for(let s=0;s<o;s++)c=h.step(c,a),K+=a;Qt()}D=n,Et(),requestAnimationFrame(It)}function Lt(){c={...ot},K=0,W=h.energy(c),P.length=0,X.length=0,j.length=0,p.length=0,Nt(),Et()}function it(){const n=parseFloat(N.value)*Math.PI/180,t=parseFloat(Y.value)*Math.PI/180,e=parseFloat(tt.value),o=parseFloat(et.value);Ht.textContent=`${(+N.value).toFixed(0)}°`,Vt.textContent=`${(+Y.value).toFixed(0)}°`,Wt.textContent=`${e.toFixed(1)}`,Dt.textContent=`${o.toFixed(1)}`,ot={theta1:n,omega1:e,theta2:t,omega2:o}}function vt(n){const t=pt[n];t&&(N.value=`${(t.theta1*180/Math.PI).toFixed(0)}`,Y.value=`${(t.theta2*180/Math.PI).toFixed(0)}`,tt.value=`${t.omega1}`,et.value=`${t.omega2}`,it(),Lt(),nt.forEach(e=>e.classList.toggle("active",e.dataset.preset===n)))}ht.addEventListener("click",()=>{F=!F,ht.textContent=F?"⏸ Pause":"▶ Play",F&&(D=0)});Ot.addEventListener("click",()=>{it(),Lt()});mt.addEventListener("change",()=>{xt=parseFloat(mt.value)});[N,Y,tt,et].forEach(n=>{n.addEventListener("input",()=>{it(),nt.forEach(t=>t.classList.remove("active"))})});nt.forEach(n=>{n.addEventListener("click",()=>vt(n.dataset.preset??""))});vt("Near-linear");requestAnimationFrame(It);
